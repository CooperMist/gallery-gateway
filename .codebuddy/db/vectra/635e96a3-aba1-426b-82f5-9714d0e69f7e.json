{"chunk":0,"numChunks":1,"fileHash":"YuHF8z+YoRl9700H1FZImhA/IE+i89O8Oeqj8MkpoTA=","filePath":"backend/resolvers/types/userType.js","content":"import { ADMIN, JUDGE, STUDENT } from '../../constants'\r\nimport Show from '../../models/show'\r\n\r\nexport default {\r\n  User: {\r\n    // Judges (and Admins) are assigned to shows, Students are not\r\n    shows (user, args) {\r\n      let getShows\r\n      switch (user.type) {\r\n        case STUDENT:\r\n          return []\r\n        case ADMIN:\r\n          // Admins query against all shows\r\n          getShows = Show.findAll.bind(Show)\r\n          break\r\n        case JUDGE:\r\n          // Judges only query against their assigned shows\r\n          getShows = user.getShows.bind(user)\r\n          break\r\n      }\r\n      // Check if given date is before any show ends\r\n      if (args.date) {\r\n        return getShows({\r\n          where: {\r\n            judgingEnd: {$gte: args.date}\r\n          },\r\n          order: [['judgingStart', 'DESC']]\r\n        })\r\n      }\r\n      // For no args just find all shows this user is assigned to\r\n      return getShows({order: [['judgingStart', 'DESC']]})\r\n    }\r\n  }\r\n}\r\n"}