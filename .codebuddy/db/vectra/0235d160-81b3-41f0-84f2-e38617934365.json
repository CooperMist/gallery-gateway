{"chunk":0,"numChunks":1,"fileHash":"qhwPk/t8PkhRtVQht8r6JiYX/+26eLrnMyo1iT8vABA=","filePath":"backend/models/scholarshipSubmissions.js","content":"import DataTypes from 'sequelize'\r\nimport sequelize from '../config/sequelize'\r\nimport Portfolio from './portfolio'\r\nimport Scholarship from './scholarship'\r\n\r\n// Defines a scholarship submission object and all of its fields\r\nconst ScholarshipSubmission = sequelize.define('scholarshipSubmissions', {\r\n  essayPath: {\r\n    allowNull: false,\r\n    type: DataTypes.STRING,\r\n    onDelete: 'cascade',\r\n    onUpdate: 'cascade'\r\n  },\r\n  // id of scholarship the submission is for\r\n  scholarshipId: {\r\n    allowNull: false,\r\n    type: DataTypes.INTEGER,\r\n    references: {\r\n      model: 'scholarships',\r\n      key: 'id'\r\n    },\r\n    onDelete: 'cascade',\r\n    onUpdate: 'cascade'\r\n  },\r\n\r\n  // id of associated portfolio period\r\n  portfolioPeriodId: {\r\n    allowNull: false,\r\n    type: DataTypes.INTEGER,\r\n    references: {\r\n      model: 'portfolioPeriods',\r\n      key: 'id'\r\n    },\r\n    onDelete: 'cascade',\r\n    onUpdate: 'cascade'\r\n  },\r\n\r\n  // id of portfolio submitted\r\n  portfolioId: {\r\n    allowNull: false,\r\n    type: DataTypes.INTEGER,\r\n    references: {\r\n      model: 'portfolios',\r\n      key: 'id'\r\n    },\r\n    onDelete: 'cascade',\r\n    onUpdate: 'cascade'\r\n  },\r\n})\r\n\r\nScholarshipSubmission.prototype.getPortfolio = function getPortfolio(){\r\n  return Portfolio.findByPk(this.portfolioId)\r\n}\r\n\r\n\r\nScholarshipSubmission.prototype.getScholarship = function getScholarship(){\r\n  return Scholarship.findByPk(this.scholarshipId)\r\n}\r\n\r\nScholarshipSubmission.prototype.getScholarshipByPortfolio = function getScholarshipByPortfolio(portfolioId){\r\n  return ScholarshipSubmission.findAll({\r\n    include: [{\r\n      model: sequelize.models.scholarship,\r\n      attributes: ['name'],\r\n      where: {\r\n        id: this.scholarshipId\r\n      }\r\n    }],\r\n    where: {\r\n      portfolioId: portfolioId\r\n    }\r\n  })\r\n}\r\n\r\n\r\nexport default ScholarshipSubmission"}