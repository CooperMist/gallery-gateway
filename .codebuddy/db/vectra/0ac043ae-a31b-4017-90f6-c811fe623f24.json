{"chunk":0,"numChunks":1,"fileHash":"mbstt1zVDA4oGKcvdZQcB5bF/1Rx78IcFmSq0IIWjes=","filePath":"backend/models/video.js","content":"import Entry from './entry'\r\nimport { VIDEO_ENTRY, ALLOWED_VIDEO_PROVIDERS } from '../constants'\r\nimport DataTypes from 'sequelize'\r\nimport sequelize from '../config/sequelize'\r\n\r\nconst Video = sequelize.define('video', {\r\n  provider: {\r\n    type: DataTypes.STRING,\r\n    allowNull: false,\r\n    notEmpty: true\r\n  },\r\n  videoId: {\r\n    type: DataTypes.STRING,\r\n    allowNull: false,\r\n    notEmpty: true\r\n  },\r\n  createdAt: {\r\n    allowNull: false,\r\n    type: DataTypes.DATE\r\n  },\r\n  updatedAt: {\r\n    allowNull: false,\r\n    type: DataTypes.DATE\r\n  }\r\n},\r\n{\r\n  validate: {\r\n    allowed_provider () {\r\n      if (!ALLOWED_VIDEO_PROVIDERS.has(this.provider)) {\r\n        throw new Error('Video source must be from youtube or vimeo')\r\n      }\r\n    }\r\n  }\r\n})\r\n\r\nVideo.prototype.getEntry = function getEntry () {\r\n  return Entry.findOne({where: {entryType: VIDEO_ENTRY, entryId: this.id}})\r\n}\r\n\r\nexport default Video\r\n"}