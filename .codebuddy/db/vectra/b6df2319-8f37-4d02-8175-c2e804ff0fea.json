{"chunk":2,"numChunks":5,"fileHash":"cWvoqHYwuGtipLnIZtCfp761H+eBYWHJZUhvVs+lyqI=","filePath":"deploy/deploy.sh","content":"#! /bin/bash\nwget $GIT_URL -O \"$DEST_FOLDER.zip\";\nunzip -d $DEST_FOLDER \"$DEST_FOLDER.zip\";\ncd $DEST_FOLDER;\ncd `ls`;\nPROJECT_ROOT=`pwd`;\nNODE_ENV=production\n#\n# Install dependencies & Build the Frontend\n#\ncd $PROJECT_ROOT/frontend;\nyarn install;\nyarn run build;\n#\n# Install dependencies & Build the Backend\n#\ncd $PROJECT_ROOT/backend;\nnpm install;\nnpm run build;\n#\n# Move the Frontend to Static Site Directory\n#\n# Remove any existing builds\ncd $PROJECT_ROOT/frontend;\nsudo rm -rf /var/www/html/*;\nsudo cp -r dist/* /var/www/html/;\n#\n# Take down old server\n#\nsudo supervisorctl stop gallerygateway > /dev/null;\n#\n# Ensure existence of the backend directory structure\n#\nsudo mkdir -p /opt/node/gallerygateway;\nsudo mkdir -p /opt/node/gallerygateway/keys;\nsudo mkdir -p /opt/node/gallerygateway/uploads;\nsudo chown $NODE_USER /opt/node/gallerygateway;\nsudo chown $NODE_USER /opt/node/gallerygateway/keys;\nsudo chown $NODE_USER /opt/node/gallerygateway/uploads;\n#\n# Copy backend files into place\n#\ncd $PROJECT_ROOT/backend;\nsudo cp build/main.js /opt/node/gallerygateway/;\nsudo rm -rf /opt/node/gallerygateway/node_modules;\nsudo mv node_modules /opt/node/gallerygateway/;\n#\n# Create the environment variables\n#\nsudo rm -f /opt/node/gallerygateway/.env;"}