{"chunk":0,"numChunks":1,"fileHash":"iQqG2j+T4v6q97FNBtSnYFjNOcEQnv2xauZdTBwCH1E=","filePath":"backend/resolvers/types/portfolioPeriodType.js","content":"import Portfolio from \"../../models/portfolio\"\r\nimport PortfolioRating from \"../../models/portfolioRating\"\r\n\r\nexport default {\r\n    PortfolioPeriod: {\r\n      judges (portfolioPeriod, _, context) {\r\n        return portfolioPeriod.getJudges()\r\n      },\r\n      portfolios (portfolioPeriod, _, context) {\r\n        return portfolioPeriod.getPortfolios()\r\n      },\r\n      ownRatings (portfolioPeriod, _, context) {\r\n        return Portfolio.findAll({ where: { portfolioPeriodId: portfolioPeriod.id } }).then((periodPortfolios) => {\r\n          // search for the portfolios that match the permission constraints\r\n          const portfolioIds = periodPortfolios.map(portfolio => portfolio.id)\r\n          return PortfolioRating.findAll({\r\n            where: {\r\n              judgeUsername: context.username,\r\n              portfolioId: portfolioIds\r\n            }\r\n          })\r\n        })\r\n      }\r\n    }\r\n  }\r\n  "}