{"chunk":0,"numChunks":1,"fileHash":"CJub1erp8iArIBaDeYHoxAAkuDPajZW6FAJV4fdrZMg=","filePath":"frontend/src/Student/containers/ScholarshipCard.js","content":"// GraphQL and Redux State\r\nimport { graphql } from 'react-apollo'\r\nimport { connect } from 'react-redux'\r\nimport { compose } from 'recompose'\r\nimport { displayError } from '../../shared/actions'\r\nimport ScholarshipCard from '../components/scholarships/ScholarshipCard'\r\n\r\nimport HasSubmittedScholarshipQuery from \"../queries/scholarships/hasSubmittedToScholarship.graphql\"\r\nimport CreateScholarshipSubmission from \"../mutations/createScholarshipSubmission.graphql\"\r\n\r\nconst mapStateToProps = state => ({\r\n    studentUsername: state.shared.auth.user.username\r\n})\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n    handleError: message => dispatch(displayError(message))\r\n})\r\n\r\nexport default compose(\r\n    connect(mapStateToProps, mapDispatchToProps),\r\n    // Query for if this scholarship has been submitted to with this portfolio\r\n    graphql(HasSubmittedScholarshipQuery, {\r\n        props: ({ data: { scholarshipSubmissions, loading, error } }) => ({\r\n            scholarshipSubmissions,\r\n            loading,\r\n            error\r\n        }),\r\n        options: ({scholarship, portfolioId, portfolioPeriodId}) => ({\r\n            variables: {\r\n                scholarshipId: parseInt(scholarship.id),\r\n                portfolioId,\r\n                portfolioPeriodId\r\n            }\r\n        })\r\n    }),\r\n    graphql(CreateScholarshipSubmission, {\r\n        props: ({ mutate }) => ({\r\n            createScholarshipSubmission: submission =>\r\n            mutate({\r\n              variables: { input: submission }\r\n            }),\r\n        }),\r\n        // refetch the HasSubmittedScholarshipQuery so that the card updates to submitted state when the mutation completes\r\n        options: ({scholarship, portfolioId, portfolioPeriodId}) => ({\r\n            refetchQueries: [\r\n              {\r\n                query: HasSubmittedScholarshipQuery,\r\n                variables: {\r\n                    scholarshipId: parseInt(scholarship.id),\r\n                    portfolioId,\r\n                    portfolioPeriodId\r\n                }\r\n              }\r\n            ]\r\n          })\r\n      }),\r\n)(ScholarshipCard)\r\n"}