{"chunk":18,"numChunks":46,"fileHash":"rgY5LIVyu8ZXHuBTfXMXoWx/ctH+OGAgjLxB0j9j1Bs=","filePath":"backend/routes/download.js","content":"import fs from 'fs'\nrouter.route('/csv/:showId')\n  .get(ensureAdminDownloadToken, (req, res, next) => {\n    Show.findByPk(req.params.showId, { rejectOnEmpty: true })\n      .then(show => {\n        Entry.findAll({ where: { showId: req.params.showId } })\n          .then(entries => {\n            // Get the additonal information on the entries by getting\n            // all the ids and then making the call, to reduce calls to the db\n            const imageIds = []\n            const videoIds = []\n            const otherMediaIds = []\n            entries.forEach((entry) => {\n              if (entry.entryType === IMAGE_ENTRY) {\n                imageIds.push(entry.entryId)\n              } else if (entry.entryType === VIDEO_ENTRY) {\n                videoIds.push(entry.entryId)\n              } else if (entry.entryType === OTHER_ENTRY) {\n                otherMediaIds.push(entry.entryId)\n              }\n            })"}